/*
 * GitPHP
 * 
 * @author Christopher Han <xiphux@gmail.com>
 * @copyright Copyright (c) 2012 Christopher Han
 * @package GitPHP
 * @subpackage Javascript
 */
define("modules/geturl",["module"],function(b){return b.config().baseurl});define("modules/resources",["module"],function(b){return b.config().resources});
define("modules/treedrilldown",["jquery","modules/geturl","modules/resources"],function(b,f,g){function e(c,a){var d=b(document.createElement("a"));d.attr("href",c);d.text(a);d.addClass("jsTree");d.addClass("expander");return d}function d(){j.find("a.treeLink").each(function(){var c=b(this),a=c.attr("href");c.parent().parent().find("td.expander").append(e(a,i))})}function a(c,a,d){d.is(":visible")?(d.hide(),d.each(function(){var a=b(this);a.data("parent")==c&&a.data("expanded",!1)}),a.find("a.expander").text(i)):
(d.each(function(){var a=b(this);if(a.data("parent")==c||a.data("expanded")==!0)a.show(),a.data("expanded",!0)}),a.find("a.expander").text(h))}function c(c,a,d){var l=a.data("depth")||0;l++;var k=b(document.createElement("img"));k.attr("src",f+"images/tree-loader.gif");k.attr("alt",g.Loading);k.addClass("treeSpinner");a.find("a.treeLink").after(k);b.get(d,{o:"js"},function(d){var k=b(d);k.addClass(c);d=a.attr("class").split(/\s+/);b.each(d,function(b,c){c.match(/[0-9a-fA-F]{40}/)&&k.addClass(c)});
k.each(function(){var a=b(this);a.data("parent",c);a.data("expanded",!0);a.data("depth",l);var d=a.find("td.fileName");(a=a.find("a.treeLink"))&&a.size()>0?d.prepend(e(a.attr("href"),i)):d.prepend(o);for(a=1;a<l;a++)d.prepend(o)});a.after(k);a.find("a.expander").text(h);a.find("img.treeSpinner").remove()})}var i="[+]",h="[\u2013]",o="\u2014",j=null,n=function(){var d=b(this),f=d.attr("href").match(/h=([0-9a-fA-F]{4,40}|HEAD)/);f||(f=d.attr("href").match(/\/trees\/([0-9a-fA-F]{4,40})/));if(!f)return!1;
var f=f[1],e=b(this).parent().parent(),l=j.find("."+f);l&&l.size()>0?a(f,e,l):c(f,e,d.attr("href"));return!1};return{init:function(a){j=a;d();j.find("a.jsTree").live("click",n)}}});define("modules/getproject",["module"],function(b){return b.config().project||null});define("modules/lang",["jquery"],function(){return function(b){b.find("select").change(function(){b.find("form").submit()});b.find('input[type="submit"]').remove()}});
define("modules/snapshotformats",["module"],function(b){return b.config().formats||null});
define("modules/tooltip.snapshot",["jquery","modules/snapshotformats","modules/resources"],function(b,f,g){function e(b){var a="<div>"+g.Snapshot+": ",c=!0,e=b.indexOf("/snapshot")!=-1,h;for(h in f)f.hasOwnProperty(h)&&(c||(a+=" | "),e?(c=b.replace("/snapshot","/"+h),a+='<a href="'+c+'">'+f[h]+"</a>"):a+='<a href="'+b+"&fmt="+h+'">'+f[h]+"</a>",c=!1);a+="</div>";return a}return function(d){d&&d.size()>0&&require(["qtip"],function(){d.each(function(){var a=b(this),c=a.attr("href"),c={content:{text:e(c)},
show:{event:"click"},hide:{fixed:!0,delay:150},style:{classes:"ui-tooltip-gitphp ui-tooltip-light ui-tooltip-shadow"},position:{viewport:b(window)}};a.qtip(c);a.click(function(){return!1})})})}});
define("modules/tooltip.commit",["jquery","modules/geturl","modules/getproject","modules/resources"],function(b,f,g,e){return function(d){d&&d.size()>0&&require(["qtip"],function(){d.each(function(){var a=b(this),c;(c=a.attr("href").match(/h=([0-9a-fA-F]{4,40}|HEAD)/))||(c=a.attr("href").match(/\/commits\/([0-9a-fA-F]{4,40}|HEAD)/));if(c=c?c[1]:null)c={content:{text:'<img src="'+f+'images/tooltip-loader.gif" alt="'+e.Loading+'" />',ajax:{url:f,data:{p:g,a:"commit",o:"jstip",h:c},type:"GET"}},style:{classes:"ui-tooltip-gitphp ui-tooltip-light ui-tooltip-shadow"},
position:{viewport:b(window)}},a.qtip(c)})})}});
define("modules/tooltip.tag",["jquery","modules/geturl","modules/getproject","modules/resources"],function(b,f,g,e){return function(d){d&&d.size()>0&&require(["qtip"],function(){d.each(function(){var a=b(this),c;(c=a.attr("href").match(/t=([^&]+)/))||(c=a.attr("href").match(/\/tags\/([^\/\?]+)/));if(c=c?c[1]:null)c={content:{text:'<img src="'+f+'images/tooltip-loader.gif" alt="'+e.Loading+'" />',ajax:{url:f,data:{p:g,a:"tag",o:"jstip",t:c},type:"GET"}},style:{classes:"ui-tooltip-gitphp ui-tooltip-light ui-tooltip-shadow"},
position:{viewport:b(window)}},a.qtip(c)})})}});
define("modules/loginpopup",["jquery","modules/geturl","modules/resources","qtip"],function(b,f,g){return function(e){b(e).qtip({content:{text:function(){var d=b(document.createElement("div")),a=b(document.createElement("div")).addClass("loginError").addClass("error").css("padding-top","0px"),c=b(document.createElement("div")).addClass("loginForm"),e=b(document.createElement("form"));d.append(c);c.append(e);e.append(a);var c=b(document.createElement("div")).addClass("field"),a=b(document.createElement("label")).attr("for",
"username").text(g.UsernameLabel),h=b(document.createElement("input")).attr("type","text").attr("name","username").attr("id","username");c.append(a);c.append(h);e.append(c);c=b(document.createElement("div")).addClass("field");a=b(document.createElement("label")).attr("for","password").text(g.PasswordLabel);h=b(document.createElement("input")).attr("type","password").attr("name","password").attr("id","password");c.append(a);c.append(h);e.append(c);c=b(document.createElement("div")).addClass("submit");
a=b(document.createElement("input")).attr("type","submit").attr("value",g.Login);c.append(a);e.append(c);e.bind("submit",function(){var a=b("input[name=username]",this).val(),c=b("input[name=password]",this).val(),d=b(".loginError",this);if(!a)return d.text(g.UsernameIsRequired),!1;if(!c)return d.text(g.PasswordIsRequired),!1;d.text("");var e=b("input",this);b.ajax({url:f+"?a=login&o=js",data:{a:"login",o:"js",username:a,password:c},type:"post",dataType:"json",success:function(a){a?a.success===!0?
window.location.reload():a.message?d.text(a.message):d.text(g.AnErrorOccurredWhileLoggingIn):d.text(g.AnErrorOccurredWhileLoggingIn)},error:function(){d.text(g.AnErrorOccurredWhileLoggingIn)},beforeSend:function(){e.attr("disabled","disabled")},complete:function(){e.removeAttr("disabled")}});return!1});return d},title:{text:g.LoginTitle,button:!0}},position:{my:"center",at:"center",target:b(window)},show:{event:"click",modal:{on:!0}},hide:{event:!1},style:{classes:"ui-tooltip-light ui-tooltip-shadow"},
events:{visible:function(){b("input[name=username]",this).focus()}}});b(e).click(function(){return!1})}});
window.Modernizr=function(b,f){function g(){e.input=function(a){for(var d=0,e=a.length;d<e;d++)h[a[d]]=!!(a[d]in c);if(h.list)h.list=!(!f.createElement("datalist")||!b.HTMLDataListElement);return h}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" "))}var e={},d=f.documentElement,a=f.createElement("modernizr"),a=a.style,c=f.createElement("input"),i={},h={},o=[],j=o.slice,n,p={}.hasOwnProperty,q;q=typeof p!=="undefined"&&typeof p.call!=="undefined"?function(a,
b){return p.call(a,b)}:function(a,b){return b in a&&typeof a.constructor.prototype[b]==="undefined"};if(!Function.prototype.bind)Function.prototype.bind=function(a){var b=this;if(typeof b!="function")throw new TypeError;var c=j.call(arguments,1),d=function(){if(this instanceof d){var e=function(){};e.prototype=b.prototype;var e=new e,f=b.apply(e,c.concat(j.call(arguments)));return Object(f)===f?f:e}else return b.apply(a,c.concat(j.call(arguments)))};return d};for(var r in i)q(i,r)&&(n=r.toLowerCase(),
e[n]=i[r](),o.push((e[n]?"":"no-")+n));e.input||g();e.addTest=function(a,b){if(typeof a=="object")for(var c in a)q(a,c)&&e.addTest(c,a[c]);else{a=a.toLowerCase();if(e[a]!==void 0)return e;b=typeof b=="function"?b():b;typeof enableClasses!=="undefined"&&enableClasses&&(d.className+=" "+(b?"":"no-")+a);e[a]=b}return e};a.cssText="";a=c=null;e._version="2.6.2";e.testStyles=function(a,b,c,e){var g,h,i=f.createElement("div"),j=f.body,m=j||f.createElement("body");if(parseInt(c,10))for(;c--;)g=f.createElement("div"),
g.id=e?e[c]:"modernizr"+(c+1),i.appendChild(g);c=['&#173;<style id="smodernizr">',a,"</style>"].join("");i.id="modernizr";(j?i:m).innerHTML+=c;m.appendChild(i);if(!j)m.style.background="",m.style.overflow="hidden",h=d.style.overflow,d.style.overflow="hidden",d.appendChild(m);a=b(i,a);j?i.parentNode.removeChild(i):(m.parentNode.removeChild(m),d.style.overflow=h);return!!a};return e}(this,this.document);define("modernizr",function(){});
define("common","jquery,module,modules/getproject,modules/lang,modules/tooltip.snapshot,modules/tooltip.commit,modules/tooltip.tag,modules/loginpopup,modernizr".split(","),function(b,f,g,e,d,a,c,i){b(function(){e(b("div.lang_select"));d(b("a.snapshotTip"));g&&(a(b("a.commitTip")),c(b("a.tagTip")));Modernizr.input.autofocus||b("input[autofocus]").filter(":first").focus();i("a.loginLink")});f.config().debug&&require(["modules/debug"])});
define("tree",["jquery","modules/treedrilldown","common"],function(b,f){b(function(){f.init(b("table.treeTable"))})});